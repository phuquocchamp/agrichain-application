# üåæ H∆∞·ªõng d·∫´n T√≠nh nƒÉng AgriChain

AgriChain l√† m·ªôt n·ªÅn t·∫£ng chu·ªói cung ·ª©ng n√¥ng nghi·ªáp d·ª±a tr√™n blockchain, ƒë∆∞·ª£c thi·∫øt k·∫ø ƒë·ªÉ ƒë·∫£m b·∫£o t√≠nh minh b·∫°ch, b·∫£o m·∫≠t v√† hi·ªáu qu·∫£ t·ª´ trang tr·∫°i ƒë·∫øn ng∆∞·ªùi ti√™u d√πng.

## üöÄ C√°c T√≠nh nƒÉng Ch√≠nh

### 1. V√≤ng ƒë·ªùi Chu·ªói cung ·ª©ng (Supply Chain Lifecycle)
H·ªá th·ªëng qu·∫£n l√Ω to√†n b·ªô v√≤ng ƒë·ªùi c·ªßa s·∫£n ph·∫©m n√¥ng nghi·ªáp qua c√°c giai ƒëo·∫°n:
- **S·∫£n xu·∫•t (Produce)**: N√¥ng d√¢n t·∫°o s·∫£n ph·∫©m m·ªõi v·ªõi m√£ ƒë·ªãnh danh duy nh·∫•t v√† l∆∞u tr·ªØ th√¥ng tin tr√™n IPFS.
- **Rao b√°n (For Sale)**: Ni√™m y·∫øt s·∫£n ph·∫©m v·ªõi gi√° c·ª• th·ªÉ.
- **Mua h√†ng (Purchase)**: Nh√† ph√¢n ph·ªëi, nh√† b√°n l·∫ª ho·∫∑c ng∆∞·ªùi ti√™u d√πng mua s·∫£n ph·∫©m.
- **V·∫≠n chuy·ªÉn (Shipped)**: X√°c nh·∫≠n vi·ªác g·ª≠i h√†ng.
- **Nh·∫≠n h√†ng (Received)**: X√°c nh·∫≠n ƒë√£ nh·∫≠n h√†ng th√†nh c√¥ng.
- **Ch·∫ø bi·∫øn & ƒê√≥ng g√≥i (Processed & Packaged)**: Nh√† ph√¢n ph·ªëi c√≥ th·ªÉ ch·∫ø bi·∫øn (v√≠ d·ª•: c·∫Øt l√°t) v√† ƒë√≥ng g√≥i l·∫°i s·∫£n ph·∫©m tr∆∞·ªõc khi b√°n ti·∫øp.

### 2. Ki·ªÉm so√°t Truy c·∫≠p theo Vai tr√≤ (RBAC)
D·ª± √°n s·ª≠ d·ª•ng m√¥ h√¨nh ph√¢n quy·ªÅn nghi√™m ng·∫∑t ƒë·ªÉ ƒë·∫£m b·∫£o ƒë√∫ng ng∆∞·ªùi th·ª±c hi·ªán ƒë√∫ng vi·ªác:
- **Farmer (N√¥ng d√¢n)**: S·∫£n xu·∫•t, ni√™m y·∫øt v√† v·∫≠n chuy·ªÉn s·∫£n ph·∫©m th√¥.
- **Distributor (Nh√† ph√¢n ph·ªëi)**: Mua t·ª´ n√¥ng d√¢n, ch·∫ø bi·∫øn, ƒë√≥ng g√≥i v√† b√°n cho nh√† b√°n l·∫ª.
- **Retailer (Nh√† b√°n l·∫ª)**: Mua t·ª´ nh√† ph√¢n ph·ªëi v√† b√°n cho ng∆∞·ªùi ti√™u d√πng cu·ªëi c√πng.
- **Consumer (Ng∆∞·ªùi ti√™u d√πng)**: Mua s·∫£n ph·∫©m cu·ªëi c√πng v√† c√≥ th·ªÉ ƒë√°nh gi√° ch·∫•t l∆∞·ª£ng.
- **Admin/Arbitrator (Qu·∫£n tr·ªã vi√™n/Tr·ªçng t√†i)**: Qu·∫£n l√Ω h·ªá th·ªëng, x√°c minh ng∆∞·ªùi d√πng v√† gi·∫£i quy·∫øt tranh ch·∫•p.

### 3. H·ªá th·ªëng K√Ω qu·ªπ & Gi·∫£i quy·∫øt Tranh ch·∫•p (Escrow & Dispute Resolution)
ƒê·∫£m b·∫£o an to√†n t√†i ch√≠nh cho m·ªçi giao d·ªãch:
- **K√Ω qu·ªπ t·ª± ƒë·ªông**: Ti·ªÅn thanh to√°n ƒë∆∞·ª£c gi·ªØ trong h·ª£p ƒë·ªìng Escrow cho ƒë·∫øn khi ng∆∞·ªùi mua x√°c nh·∫≠n ƒë√£ nh·∫≠n h√†ng.
- **M·ªü tranh ch·∫•p**: N·∫øu c√≥ v·∫•n ƒë·ªÅ v·ªÅ ch·∫•t l∆∞·ª£ng ho·∫∑c v·∫≠n chuy·ªÉn, c√°c b√™n c√≥ th·ªÉ m·ªü tranh ch·∫•p.
- **Tr·ªçng t√†i**: Qu·∫£n tr·ªã vi√™n ƒë√≥ng vai tr√≤ tr·ªçng t√†i ƒë·ªÉ quy·∫øt ƒë·ªãnh ho√†n ti·ªÅn cho ng∆∞·ªùi mua, thanh to√°n cho ng∆∞·ªùi b√°n ho·∫∑c chia ƒë√¥i s·ªë ti·ªÅn.

### 4. H·ªá th·ªëng Danh ti·∫øng (Reputation System)
X√¢y d·ª±ng ni·ªÅm tin trong m·∫°ng l∆∞·ªõi:
- **ƒê√°nh gi√° & Nh·∫≠n x√©t**: Ng∆∞·ªùi d√πng c√≥ th·ªÉ ƒë√°nh gi√° l·∫´n nhau sau m·ªói giao d·ªãch (1-5 sao).
- **ƒêi·ªÉm s·ªë danh ti·∫øng**: T·ª± ƒë·ªông c·∫≠p nh·∫≠t d·ª±a tr√™n l·ªãch s·ª≠ giao d·ªãch th√†nh c√¥ng/th·∫•t b·∫°i v√† c√°c ƒë√°nh gi√° ƒë√£ ƒë∆∞·ª£c x√°c minh.
- **C·∫•p ƒë·ªô danh ti·∫øng**: Ph√¢n lo·∫°i ng∆∞·ªùi d√πng t·ª´ "R·∫•t k√©m" ƒë·∫øn "Xu·∫•t s·∫Øc".

### 5. Qu·∫£n l√Ω Ch·∫•t l∆∞·ª£ng & H·∫°n s·ª≠ d·ª•ng
- **Theo d√µi h·∫°n v·∫≠n chuy·ªÉn**: ƒê·∫∑t th·ªùi h·∫°n cho vi·ªác giao h√†ng. N·∫øu qu√° h·∫°n, ng∆∞·ªùi mua c√≥ th·ªÉ y√™u c·∫ßu ho√†n ti·ªÅn.
- **Th√¥ng tin IPFS**: L∆∞u tr·ªØ ch·ª©ng ch·ªâ ch·∫•t l∆∞·ª£ng, h√¨nh ·∫£nh v√† th√¥ng tin chi ti·∫øt s·∫£n ph·∫©m m·ªôt c√°ch phi t·∫≠p trung.

---

## üìñ H∆∞·ªõng d·∫´n S·ª≠ d·ª•ng

### B∆∞·ªõc 1: Thi·∫øt l·∫≠p M√¥i tr∆∞·ªùng
1. C√†i ƒë·∫∑t MetaMask v√† th√™m m·∫°ng **Polygon Amoy** ho·∫∑c s·ª≠ d·ª•ng m·∫°ng **Localhost**.
2. ƒê·∫£m b·∫£o b·∫°n c√≥ m·ªôt √≠t MATIC th·ª≠ nghi·ªám (Faucet t·∫°i [Polygon Faucet](https://faucet.polygon.technology/)).

### B∆∞·ªõc 2: C·∫•p quy·ªÅn Vai tr√≤ (D√†nh cho Admin)
Truy c·∫≠p trang **Admin** tr√™n ·ª©ng d·ª•ng ƒë·ªÉ:
1. G√°n vai tr√≤ (Farmer, Distributor, v.v.) cho c√°c ƒë·ªãa ch·ªâ v√≠ t∆∞∆°ng ·ª©ng.
2. X√°c minh ng∆∞·ªùi d√πng (Verify User) ƒë·ªÉ h·ªç c√≥ th·ªÉ th·ª±c hi·ªán c√°c thao t√°c tr√™n chu·ªói.

### B∆∞·ªõc 3: Th·ª±c hi·ªán Quy tr√¨nh Chu·ªói cung ·ª©ng

#### üë®‚Äçüåæ Vai tr√≤ N√¥ng d√¢n (Farmer Role)
N√¥ng d√¢n l√† kh·ªüi ƒë·∫ßu c·ªßa chu·ªói cung ·ª©ng. C√°c ch·ª©c nƒÉng ch√≠nh bao g·ªìm:

1.  **S·∫£n xu·∫•t S·∫£n ph·∫©m (Produce Item)**:
    - N√¥ng d√¢n t·∫°o m·ªôt l√¥ h√†ng m·ªõi tr√™n h·ªá th·ªëng.
    - C·∫ßn cung c·∫•p: T√™n s·∫£n ph·∫©m, M√¥ t·∫£, m√£ IPFS (ch·ª©a h√¨nh ·∫£nh/ch·ª©ng ch·ªâ), Gi√° kh·ªüi ƒëi·ªÉm v√† H·∫°n v·∫≠n chuy·ªÉn.
    - **ƒêi·ªÅu ki·ªán**: N√¥ng d√¢n ph·∫£i ƒë∆∞·ª£c Admin x√°c minh (Verified) tr∆∞·ªõc khi c√≥ th·ªÉ s·∫£n xu·∫•t.

2.  **Rao b√°n S·∫£n ph·∫©m (Sell Item)**:
    - Sau khi s·∫£n xu·∫•t, n√¥ng d√¢n c√≥ th·ªÉ c·∫≠p nh·∫≠t gi√° v√† ƒë∆∞a s·∫£n ph·∫©m l√™n th·ªã tr∆∞·ªùng ƒë·ªÉ c√°c Nh√† ph√¢n ph·ªëi c√≥ th·ªÉ t√¨m th·∫•y v√† mua.

3.  **V·∫≠n chuy·ªÉn (Ship Item)**:
    - Sau khi Nh√† ph√¢n ph·ªëi ƒë√£ thanh to√°n (ti·ªÅn ƒë∆∞·ª£c gi·ªØ trong Escrow), n√¥ng d√¢n th·ª±c hi·ªán g·ª≠i h√†ng v√† c·∫≠p nh·∫≠t tr·∫°ng th√°i "Shipped" tr√™n h·ªá th·ªëng.

#### üí∞ Quy t·∫Øc Ki·ªÉm tra Gi√° (Price Validation)
H·ªá th·ªëng √°p d·ª•ng c√°c quy t·∫Øc ki·ªÉm tra gi√° nghi√™m ng·∫∑t ƒë·ªÉ ƒë·∫£m b·∫£o t√≠nh h·ª£p l√Ω:

- **Gi·ªõi h·∫°n H·ª£p ƒë·ªìng (Smart Contract Level)**:
    - **Gi√° t·ªëi thi·ªÉu (Min Price)**: 0.001 ETH.
    - **Gi√° t·ªëi ƒëa (Max Price)**: 1000 ETH.
    - B·∫•t k·ª≥ giao d·ªãch n√†o c√≥ gi√° n·∫±m ngo√†i kho·∫£ng n√†y s·∫Ω b·ªã h·ª£p ƒë·ªìng t·ª´ ch·ªëi (Revert).
- **Ki·ªÉm tra Giao di·ªán (Frontend Level)**:
    - Form nh·∫≠p li·ªáu c√≥ thu·ªôc t√≠nh `min="0.001"` v√† `max="1000"` ƒë·ªÉ ngƒÉn ch·∫∑n nh·∫≠p sai ngay t·ª´ ƒë·∫ßu.
    - H·ªá th·ªëng t·ª± ƒë·ªông chuy·ªÉn ƒë·ªïi t·ª´ ƒë∆°n v·ªã ETH sang Wei tr∆∞·ªõc khi g·ª≠i l√™n Blockchain.

---

### B∆∞·ªõc 4: C√°c Vai tr√≤ kh√°c
1. **Nh√† ph√¢n ph·ªëi**: Chuy·ªÉn sang v√≠ Distributor -> T√¨m s·∫£n ph·∫©m -> "Purchase" -> Sau khi nh·∫≠n h√†ng, ch·ªçn "Receive" -> "Process" -> "Package" -> "Sell".
2. **Nh√† b√°n l·∫ª**: Chuy·ªÉn sang v√≠ Retailer -> "Purchase" -> "Receive" -> "Sell".
3. **Ng∆∞·ªùi ti√™u d√πng**: Chuy·ªÉn sang v√≠ Consumer -> "Purchase" -> Ho√†n t·∫•t quy tr√¨nh.

---

## üß™ H∆∞·ªõng d·∫´n Ki·ªÉm th·ª≠ (Testing)

### 1. Ki·ªÉm th·ª≠ T·ª± ƒë·ªông (Hardhat)
Ch·∫°y l·ªánh sau t·∫°i th∆∞ m·ª•c g·ªëc c·ªßa d·ª± √°n:
```bash
npm test
```
B·ªô ki·ªÉm th·ª≠ s·∫Ω ki·ªÉm tra:
- Logic t·∫°o v√† qu·∫£n l√Ω s·∫£n ph·∫©m.
- Quy tr√¨nh mua b√°n v√† chuy·ªÉn tr·∫°ng th√°i.
- H·ªá th·ªëng k√Ω qu·ªπ v√† gi·∫£i quy·∫øt tranh ch·∫•p.
- Ph√¢n quy·ªÅn truy c·∫≠p.

### 2. Ki·ªÉm th·ª≠ Th·ªß c√¥ng tr√™n Frontend
1. Ch·∫°y node c·ª•c b·ªô: `npm run node`.
2. Deploy h·ª£p ƒë·ªìng: `npm run deploy:localhost`.
3. Ch·∫°y frontend: `cd frontend && npm run dev`.
4. M·ªü `http://localhost:3000`, k·∫øt n·ªëi v√≠ v√† th·ª±c hi·ªán quy tr√¨nh t·ª´ B∆∞·ªõc 3 ·ªü tr√™n.
5. Ki·ªÉm tra c√°c s·ª± ki·ªán (Events) v√† thay ƒë·ªïi tr·∫°ng th√°i s·∫£n ph·∫©m trong m·ª•c "Journeys".
